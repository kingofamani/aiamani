# Web 教學白板 (MVP+)

## 專案簡介

本專案旨在建立一個網頁版的互動式教學白板，提供教師或簡報者一個方便的線上工具。目前已完成 MVP+ (Minimum Viable Product Plus) 核心功能，包含統一控制邏輯系統，正在規劃進階的專案管理系統。
靈感來源：classroomscreen.com

## 🎯 專案狀態

### ✅ 已完成功能 (MVP+ 完成)

1.  **畫布 (Canvas)**:
    *   ✅ 基本繪圖功能：
        *   畫筆 (可選顏色、粗細)
        *   橡皮擦
        *   游標選擇工具
    *   ✅ 清空畫布功能
    *   ✅ 畫布尺寸自動填滿整個瀏覽器視窗 (100% 寬高)
    *   ✅ RWD 響應式調整，內容保留與重繪

2.  **背景管理 (Background Management)**:
    *   ✅ 允許使用者更換畫布背景：
        *   純色背景 (白色、淺灰、自訂顏色)
        *   預設圖片背景 (格線)

3.  **文字工具 (Text Tool)**:
    *   ✅ 允許使用者在畫布上新增文字框
    *   ✅ 可以輸入文字內容
    *   ✅ 文字保留和重繪功能

4.  **統一控制邏輯系統 (BaseControlModule)** ⭐:
    *   ✅ **統一3按鈕控制體驗**：
        *   移動按鈕 (綠色手掌圖示，左上角)
        *   刪除按鈕 (紅色垃圾桶圖示，右上角)
        *   縮放按鈕 (藍色箭頭圖示，右下角)
    *   ✅ **點擊內容顯示控制項**：只有在游標工具模式下才響應
    *   ✅ **工具切換自動隱藏**：切換工具時自動隱藏所有控制項
    *   ✅ **統一事件處理**：拖拽移動、縮放調整、鍵盤刪除 (Delete鍵)
    *   ✅ **模組化繼承架構**：所有可放置內容都繼承相同基礎邏輯

5.  **便條紙 (Sticky Notes)** [繼承統一控制]:
    *   ✅ 允許使用者新增便條紙到畫布上
    *   ✅ 可以在便條紙上輸入文字
    *   ✅ 便條紙可以被拖拽移動和縮放調整
    *   ✅ 縮放時字體自動調整大小
    *   ✅ 統一3按鈕控制體驗
    *   ✅ 點擊內容區域即可顯示控制項

6.  **QR Code 產生器 (QR)**:
    *   ✅ 真實 QR Code 生成 (使用 qr-server.com API)
    *   ✅ 多種內容支援 (文字、網址、電話號碼)
    *   ✅ 自訂大小調整 (100-300px)
    *   ✅ 即時預覽功能
    *   ✅ 點擊畫布放置
    *   ✅ 錯誤處理和備用方案
    *   ✅ 內容保留和重繪
    *   ✅ 原有控制邏輯保持不變 (與其他模組一致)

7.  **YouTube 影片嵌入 (📺)** [繼承統一控制]:
    *   ✅ 支援多種 YouTube URL 格式
    *   ✅ 影片 iframe 嵌入和顯示
    *   ✅ 統一3按鈕控制體驗
    *   ✅ 點擊影片內容顯示控制項
    *   ✅ 縮放時自動保持 16:9 比例
    *   ✅ 支援全螢幕播放

8.  **圖片插入功能 (🖼️)** [繼承統一控制]:
    *   ✅ 圖片檔案選擇和上傳
    *   ✅ 圖片 URL 輸入支援
    *   ✅ 支援多種圖片格式 (JPG, PNG, GIF, WebP, SVG)
    *   ✅ 統一3按鈕控制體驗
    *   ✅ 點擊圖片內容顯示控制項
    *   ✅ 自由縮放調整
    *   ✅ Base64 編碼儲存
    *   ✅ 載入錯誤處理

9.  **計時器功能 (分離式設計)** [繼承統一控制]:
    *   ✅ **倒數計時器 (⏰)**:
        *   DOM 元素倒數計時器 (280x120px)
        *   統一3按鈕控制體驗
        *   點擊計時器內容顯示控制項
        *   分鐘/秒數調整按鈕 (±1分鐘, ±10秒)
        *   預設 10:00 分鐘
        *   計時結束聲音警報系統 (Web Audio API)
        *   Toast 通知顯示
        *   視覺提醒效果 (閃爍、變色)
        *   縮放時保持比例
    *   ✅ **碼錶 (⏱)**:
        *   DOM 元素碼錶 (320x100px)
        *   統一3按鈕控制體驗
        *   點擊碼錶內容顯示控制項
        *   百分秒精度 (10ms 更新)
        *   橫向佈局設計
        *   播放/暫停/重置控制
        *   縮放時字體自動調整
        *   預設顯示 "00:12.75"

10. **音量偵測功能 (🎤)**:
    *   ✅ 麥克風權限請求和控制
    *   ✅ 即時音量分析和視覺化
    *   ✅ 音量條動態顯示（綠/黃/紅）
    *   ✅ 閾值滑桿調節
    *   ✅ 閾值指示線顯示
    *   ✅ 音量超標警告系統
    *   ✅ 警告計數器和鈴鐺動畫
    *   ✅ Toast 通知系統
    *   ✅ 音量平滑處理和冷卻機制

11. **響應式網頁設計 (RWD)**:
    *   ✅ 畫布響應式調整
    *   ✅ 內容保留和重繪機制
    *   ✅ 工具列適應性佈局
    *   ✅ 控制項位置自動更新

### 🔄 計畫中功能

12. **專案管理系統 (🔄 計畫中)**:
    *   🔄 專案新增、命名功能
    *   🔄 專案儲存到 localStorage
    *   🔄 專案載入和選擇器
    *   🔄 專案列表管理
    *   🔄 畫布縮圖生成
    *   🔄 自動儲存機制

## 技術棧

*   **前端語言**: HTML, CSS, JavaScript (ES6+)
*   **CSS 框架**: TailwindCSS
*   **核心繪圖**: HTML5 Canvas API
*   **架構模式**: 模組化設計 + 繼承架構
*   **統一控制**: BaseControlModule 基礎類別
*   **資料儲存**: localStorage (專案管理)
*   **音頻處理**: Web Audio API
*   **開發流程**: 標準化工具開發流程 (詳見 FLOW.md)

## 檔案結構

```
WhiteBoard/
├── index.html              # 主頁面
├── css/
│   └── style.css           # 自訂樣式
├── js/
│   ├── app.js              # 主應用程式邏輯
│   ├── CanvasModule.js     # 畫布核心模組
│   ├── BackgroundModule.js # 背景管理模組
│   ├── BaseControlModule.js # 統一控制邏輯基類 ⭐
│   ├── TextToolModule.js   # 文字工具模組
│   ├── NotesModule.js      # 便條紙模組 [繼承]
│   ├── QRCodeModule.js     # QR Code 產生器模組
│   ├── YouTubeModule.js    # YouTube 影片嵌入模組 [繼承]
│   ├── ImageModule.js      # 圖片插入模組 [繼承]
│   ├── CountdownModule.js  # 倒數計時器模組 [繼承]
│   ├── StopwatchModule.js  # 碼錶模組 [繼承]
│   ├── LinkModule.js       # 超連結模組 [繼承] ⭐ 新增
│   └── VolumeDetectionModule.js # 音量偵測模組
├── README.md               # 專案說明
├── TODO.md                 # 開發待辦事項
├── FRAMEWORK.md            # 程式架構說明
├── FLOW.md                 # 程式流程圖 + 工具開發指南 ⭐
└── INIT.md                 # 專案初始化說明
```

## 功能特色

### 🎨 繪圖功能
- **多工具支援**: 游標、畫筆、橡皮擦、文字、便條紙
- **自訂設定**: 顏色選擇、線條粗細調整
- **觸控支援**: 支援滑鼠和觸控設備操作

### 🖼️ 背景管理
- **多種背景**: 白色、淺灰、格線、自訂顏色
- **即時切換**: 背景變更時保留所有繪圖內容

### 📝 文字與便條紙
- **文字工具**: 點擊畫布任意位置新增文字
- **便條紙**: 可新增、編輯、拖拽移動的便條紙，支援統一控制體驗
- **內容保留**: 所有文字和便條紙在視窗調整時保持不變

### ⭐ 統一控制體驗 (BaseControlModule)
- **一致的操作邏輯**: 所有可放置內容都有相同的3按鈕控制
- **直觀的互動方式**: 點擊內容即可顯示控制項，切換工具自動隱藏
- **標準化縮放**: 各種內容都支援比例縮放或自適應調整
- **鍵盤快捷鍵**: Delete 鍵快速刪除選中元素
- **模組化架構**: 新功能可輕易繼承統一控制邏輯

### 📱 QR Code 產生器
- **真實 QR Code**: 使用 qr-server.com API 生成可掃描的 QR code
- **多種內容支援**: 支援文字、網址、電話號碼等各種內容
- **自訂大小**: 可調整 QR code 大小（100-300px）
- **即時預覽**: 輸入內容後立即顯示 QR code 預覽
- **點擊放置**: 在畫布上點擊任意位置放置 QR code
- **錯誤處理**: 網路問題時自動使用備用方案

### 📺 YouTube 影片嵌入
- **多格式支援**: 支援各種 YouTube URL 格式
- **統一控制**: 繼承 BaseControlModule 的3按鈕控制體驗
- **自動比例**: 縮放時自動保持 16:9 比例
- **全螢幕支援**: iframe 嵌入支援全螢幕播放
- **點擊響應**: 在游標模式下點擊影片顯示控制項

### 🖼️ 圖片插入
- **多格式支援**: JPG、PNG、GIF、WebP、SVG
- **雙重輸入**: 支援檔案上傳和 URL 輸入
- **統一控制**: 繼承 BaseControlModule 的3按鈕控制體驗
- **Base64 儲存**: 圖片轉換為 Base64 格式儲存
- **錯誤處理**: 載入失敗時顯示佔位符

### ⏱️ 計時器功能 (分離式設計)
- **倒數計時器**: 
  - 可設定分鐘和秒數的倒數計時器
  - 統一3按鈕控制體驗
  - 預設 10:00 分鐘，支援 ±1分鐘、±10秒調整
  - 計時結束時播放聲音警報 (Web Audio API)
  - Toast 通知和閃爍視覺提醒
  - 縮放時保持比例
- **碼錶功能**: 
  - 精確到百分秒的碼錶計時 (10ms 精度)
  - 統一3按鈕控制體驗
  - 橫向佈局，播放/暫停/重置控制
  - 預設顯示 "00:12.75"
  - 縮放時字體自動調整
- **DOM 元素**: 所有計時器都是可拖拽、縮放、刪除的 DOM 元素

### 🎤 音量偵測
- **麥克風監控**: 即時音量分析和視覺化
- **警告系統**: 音量超標時的計數和動畫提醒
- **閾值調整**: 可自訂音量警告閾值
- **Toast 通知**: 超標時的彈出式警告

### 📱 響應式設計
- **自適應畫布**: 畫布自動填滿螢幕並響應視窗大小變化
- **內容保留**: 視窗調整時自動重繪所有內容
- **控制項更新**: 響應式調整時自動更新所有控制項位置
- **跨設備支援**: 支援桌機、平板、手機使用

### 📁 專案管理 (計畫中)
- **多專案支援**: 可建立和管理多個教學白板專案
- **專案儲存**: 將整個白板狀態儲存到 localStorage
- **縮圖預覽**: 自動生成專案縮圖供快速識別
- **自動儲存**: 定期自動儲存專案狀態

## 使用說明

### 基本操作
1. **選擇工具**: 點擊左側工具列選擇所需工具
2. **游標模式**: 選擇游標工具後，點擊任何內容都會顯示控制按鈕
3. **統一控制**: 所有可放置的內容都有相同的3按鈕控制體驗

### 統一控制邏輯
- **移動**: 拖拽移動按鈕或直接拖拽內容來移動位置
- **縮放**: 拖拽縮放按鈕來調整大小（自動保持合適比例）
- **刪除**: 點擊刪除按鈕或按下 Delete 鍵來移除內容
- **選擇**: 在游標模式下點擊內容即可顯示控制按鈕
- **隱藏**: 點擊空白區域或切換工具會自動隱藏控制按鈕

### 內容創建
- **便條紙**: 選擇便條紙工具，點擊畫布任意位置創建
- **YouTube影片**: 選擇YouTube工具，輸入影片網址後點擊畫布放置
- **圖片**: 選擇圖片工具，上傳檔案或輸入網址後點擊畫布放置
- **計時器**: 選擇計時器工具，點擊畫布任意位置創建

## 瀏覽器支援

- **現代瀏覽器**: Chrome 80+, Firefox 75+, Safari 13+, Edge 80+
- **必要功能**: HTML5 Canvas, ES6+, Web Audio API (計時器聲音)
- **推薦設定**: 允許麥克風權限 (音量偵測功能)

## 專案特色

### 🏗️ 模組化架構
- **BaseControlModule**: 提供統一的控制邏輯基類
- **繼承設計**: 所有可放置內容都繼承相同的使用者體驗
- **向後兼容**: 保持原有 API，平滑升級到統一控制

### 🎯 統一使用者體驗
- **一致性**: 所有內容都有相同的操作方式
- **直觀性**: 點擊內容就能顯示控制項
- **標準化**: 統一的移動、縮放、刪除邏輯

### 🔧 易於擴展
- **新功能**: 可輕易繼承 BaseControlModule 加入新的內容類型
- **自訂配置**: 支援自訂按鈕顏色、尺寸、工具名稱等
- **事件處理**: 標準化的事件處理模式

## 開發狀態

✅ **已完成**: 
- 完整的教學白板 MVP+ 功能
- 統一控制邏輯系統 (BaseControlModule)
- 所有互動內容的一致使用者體驗
- 響應式設計和跨設備支援
- 豐富的教學工具集合

🔄 **計畫中**: 
- 專案管理系統架構設計
- 儲存載入功能實現
- 使用者體驗優化
- 效能優化與功能擴展

## 專案展示

本專案已部署，可直接訪問以下網址：
[Web 教學白板 Demo](your-demo-url-here)

## 貢獻指南

歡迎提交 Issue 和 Pull Request 來改進這個專案！

## 開發者指南 ⭐

### 🛠️ 新增工具開發流程

如需新增自訂工具到白板，請參考詳細的開發指南：

1. **開發流程圖**: 請查看 `FLOW.md` 中的「新增工具開發流程」章節
2. **架構說明**: 請查看 `FRAMEWORK.md` 中的「工具開發流程與最佳實踐」章節
3. **程式碼範例**: 參考現有模組如 `LinkModule.js` 的實作方式

### 🔧 開發方式選擇

- **方式一（推薦）**: 繼承 `BaseControlModule` - 適用於需要標準 3 按鈕控制的工具
- **方式二**: 獨立實作 - 適用於需要特殊控制邏輯的工具

### ✅ 開發檢查清單

開發新工具時請確保：
- [ ] 正確傳遞 `appInstance` 參數
- [ ] 實作 `selectXXX` 方法並先呼叫 `app.hideAllControls()`
- [ ] 實作 `hideAllControls()` 方法
- [ ] 實作 `exportData/importData` 方法
- [ ] 在 `app.js` 中正確整合
- [ ] 通過功能測試（點擊、儲存、載入）

### 🐛 常見問題

- **按鈕顯示異常**: 檢查 app 實例傳遞和初始化順序
- **儲存載入失敗**: 確保使用 `style.left/top` 屬性而非 `getBoundingClientRect()`
- **控制項位置錯誤**: 驗證容器使用 `position: absolute`

詳細的除錯指南和程式碼範例請參考 `FLOW.md` 和 `FRAMEWORK.md`。

## 授權

MIT License 